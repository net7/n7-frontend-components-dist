//---------------------------
// CAROUSEL.ts
//---------------------------
import { __decorate, __metadata } from "tslib";
import { Component, Input } from '@angular/core';
var CarouselComponent = /** @class */ (function () {
    function CarouselComponent() {
        var _this = this;
        this.loaded = false;
        /**
         * API of the carousel component
         */
        this.api = {
            /**
             * Used to lazy-load video resources.
             * Call api.load.videos on DOMContentReady event
             */
            load: {
                /** Changes all data-src attributes to src and calls <video>.load() */
                videos: function () {
                    var sources = Array.from(// gets all <source.lazy> tags
                    document.getElementById(_this.data.containerId)
                        .getElementsByClassName('lazy'));
                    sources.forEach(function (source) {
                        var url = source.getAttribute('data-src'); // gets the video url
                        source.classList.remove('lazy'); // removes the lazy class
                        source.setAttribute('src', url); // sets the url to src attribute
                        source.removeAttribute('data-src'); // removes the data-src attribute
                        source.parentElement.load(); // loads the video
                    });
                }
            }
        };
    }
    CarouselComponent.prototype.ngAfterContentChecked = function () {
        var _this = this;
        if (!this.data || this.loaded)
            return;
        this.loaded = true;
        setTimeout(function () {
            var _a = _this.data, containerId = _a.containerId, libOptions = _a.libOptions;
            import('latte-carousel').then(function (module) {
                var Carousel = module.Carousel;
                var chart = new Carousel("#" + containerId, libOptions);
                // eslint-disable-next-line no-param-reassign, @typescript-eslint/no-unused-vars
                if (_this.data.setInstance)
                    _this.data.setInstance(function (d) { d = chart; });
                // eslint-disable-next-line no-param-reassign, @typescript-eslint/no-unused-vars
                if (_this.data.setComponentAPI)
                    _this.data.setComponentAPI(function (d) { d = _this.api; });
                _this.addButtonEvents(_this.data);
            });
        });
    };
    CarouselComponent.prototype.onClick = function (payload) {
        if (!this.emit)
            return;
        this.emit('click', payload);
    };
    /**
     * Function that adds the event listeners to each button.
     * This is needed because when "new Carousel()" is called the event listeners are lost.
     */
    CarouselComponent.prototype.addButtonEvents = function (_a) {
        var _this = this;
        var slides = _a.slides, containerId = _a.containerId;
        // Build array of button-id's & payloads.
        var buttons = slides
            .map(function (slide, slideID) { return ({
            // id = container id - index of the slide
            id: containerId + "-" + slideID,
            payload: (((slide.action || {}).anchor || {}).payload) || undefined
        }); })
            .filter(function (btn) { return btn.payload; });
        // find each button's anchor-wrapper and attach the event to it.
        buttons.forEach(function (btn) {
            document.querySelector("#" + btn.id).parentElement.addEventListener('click', function () { return _this.onClick(btn.payload); });
        });
    };
    __decorate([
        Input(),
        __metadata("design:type", Object)
    ], CarouselComponent.prototype, "data", void 0);
    __decorate([
        Input(),
        __metadata("design:type", Object)
    ], CarouselComponent.prototype, "emit", void 0);
    CarouselComponent = __decorate([
        Component({
            selector: 'n7-carousel',
            template: "<button *ngIf=\"data.classes === 'demo'\"\r\n        class=\"n7-btn\"\r\n        (click)=\"api.load.videos()\">api.load.videos()</button>\r\n\r\n<div *ngIf=\"data\"\r\n     class=\"n7-carousel {{ data.classes || '' }}\">\r\n  <!-- Warning: Do not style div.latte-carousel -->\r\n  <div id=\"{{data.containerId}}\"\r\n       class=\"latte-carousel\">\r\n    <ng-container *ngFor=\"let slide of data.slides; let index = index;\">\r\n      <ng-container *ngTemplateOutlet=\"carouselSlide; context:{slide: slide, index: index}\"></ng-container>\r\n    </ng-container>\r\n  </div>\r\n</div>\r\n\r\n<!-- ===== SLIDE WRAPPER ===== -->\r\n<ng-template #carouselSlide\r\n             let-slide=\"slide\"\r\n             let-slideID=\"index\">\r\n  <!-- Warning: Do not style div.latte-item -->\r\n  <div class=\"latte-item\">\r\n    <div class=\"n7-carousel__slide {{ slide.classes || ''}}\"\r\n         [ngClass]=\"{ 'has-image' : slide.background.image, 'has-video': slide.background.video }\"\r\n         [style.background-color]=\"slide.background.color ? slide.background.color : ''\"\r\n         [style.background-image]=\"slide.background.image ? 'url('+slide.background.image+')' : ''\">\r\n      <div class=\"n7-carousel__slide-content-wrapper\">\r\n        <div class=\"n7-carousel__slide-content\">\r\n          <div class=\"n7-carousel__slide-content-left\">\r\n            <ng-container *ngTemplateOutlet=\"slideForeground; context:{items: slide.items, slideID: slideID}\">\r\n            </ng-container>\r\n          </div>\r\n          <div class=\"n7-carousel__slide-content-right\"\r\n               *ngIf=\"slide.action\">\r\n            <n7-anchor-wrapper [data]=\"slide.action.anchor\"\r\n                               (clicked)=\"onClick($event)\">\r\n              <!-- Button ID's are used to dynamically reattach events after loading the carousel -->\r\n              <button id=\"{{data.containerId}}-{{slideID}}\"\r\n                      class=\"n7-hero__btn n7-btn n7-btn-cta n7-btn-l\">\r\n                {{slide.action.text}}\r\n              </button>\r\n            </n7-anchor-wrapper>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <ng-container *ngIf=\"slide.background\">\r\n        <ng-container *ngTemplateOutlet=\"slideBackground; context:{$implicit: slide.background}\">\r\n        </ng-container>\r\n      </ng-container>\r\n    </div>\r\n  </div>\r\n</ng-template>\r\n\r\n<!-- ===== SLIDE FOREGROUND ===== -->\r\n<ng-template #slideForeground\r\n             let-items=\"items\"\r\n             let-slideID=\"slideID\">\r\n  <ng-container *ngFor=\"let el of items; let itemID = index\">\r\n    <h1 class=\"n7-carousel__slide-title\"\r\n        *ngIf=\"el.title\">{{el.title}}</h1>\r\n    <span class=\"n7-carousel__slide-text\"\r\n          *ngIf=\"el.text\">{{el.text}}</span>\r\n    <div class=\"n7-carousel__slide-metadata-wrapper\"\r\n         *ngIf=\"el.metadata\">\r\n      <ng-container *ngFor=\"let m of el.metadata\">\r\n        <div class=\"n7-carousel__slide-metadata\">\r\n            <span class=\"n7-carousel__slide-metadata-label\"\r\n              *ngIf=\"m.key\">{{m.key}}</span>\r\n            <span class=\"n7-carousel__slide-metadata-value\"\r\n              *ngIf=\"m.value\">{{m.value}}</span>\r\n        </div>\r\n      </ng-container>\r\n    </div>\r\n  </ng-container>\r\n</ng-template>\r\n\r\n<!-- ===== VIDEO BACKGROUND ===== -->\r\n<ng-template #slideBackground\r\n             let-bg>\r\n  <ng-container *ngIf=\"bg.video as v\">\r\n    <video #video\r\n           class=\"n7-carousel__slide-video\"\r\n           [poster]=\"v.poster\"\r\n           [height]=\"v.height\"\r\n           [width]=\"v.width\"\r\n           loop\r\n           muted\r\n           autoplay\r\n           playsinline>\r\n      <source #source\r\n              class=\"lazy\"\r\n              [attr.data-src]=\"v.url\"\r\n              type=\"video/mp4\">\r\n    </video>\r\n    <div class=\"n7-carousel__slide-video-overlay\">\r\n\r\n    </div>\r\n  </ng-container>\r\n</ng-template>\r\n"
        })
    ], CarouselComponent);
    return CarouselComponent;
}());
export { CarouselComponent };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY2Fyb3VzZWwuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AbjctZnJvbnRlbmQvY29tcG9uZW50cy8iLCJzb3VyY2VzIjpbImxpYi9jb21wb25lbnRzL2Nhcm91c2VsL2Nhcm91c2VsLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLDZCQUE2QjtBQUM3QixjQUFjO0FBQ2QsNkJBQTZCOztBQUU3QixPQUFPLEVBQ0wsU0FBUyxFQUFFLEtBQUssRUFDakIsTUFBTSxlQUFlLENBQUM7QUFpSnZCO0lBQUE7UUFBQSxpQkE0RUM7UUF2RVMsV0FBTSxHQUFHLEtBQUssQ0FBQztRQUV2Qjs7V0FFRztRQUNILFFBQUcsR0FBRztZQUNKOzs7ZUFHRztZQUNILElBQUksRUFBRTtnQkFDSixzRUFBc0U7Z0JBQ3RFLE1BQU0sRUFBRTtvQkFDTixJQUFNLE9BQU8sR0FBRyxLQUFLLENBQUMsSUFBSSxDQUFFLDhCQUE4QjtvQkFDeEQsUUFBUSxDQUFDLGNBQWMsQ0FBQyxLQUFJLENBQUMsSUFBSSxDQUFDLFdBQVcsQ0FBQzt5QkFDM0Msc0JBQXNCLENBQUMsTUFBTSxDQUFDLENBQ2xDLENBQUM7b0JBQ0YsT0FBTyxDQUFDLE9BQU8sQ0FBQyxVQUFDLE1BQW1CO3dCQUNsQyxJQUFNLEdBQUcsR0FBRyxNQUFNLENBQUMsWUFBWSxDQUFDLFVBQVUsQ0FBQyxDQUFDLENBQUMscUJBQXFCO3dCQUNsRSxNQUFNLENBQUMsU0FBUyxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLHlCQUF5Qjt3QkFDMUQsTUFBTSxDQUFDLFlBQVksQ0FBQyxLQUFLLEVBQUUsR0FBRyxDQUFDLENBQUMsQ0FBQyxnQ0FBZ0M7d0JBQ2pFLE1BQU0sQ0FBQyxlQUFlLENBQUMsVUFBVSxDQUFDLENBQUMsQ0FBQyxpQ0FBaUM7d0JBQ3BFLE1BQU0sQ0FBQyxhQUFrQyxDQUFDLElBQUksRUFBRSxDQUFDLENBQUMsa0JBQWtCO29CQUN2RSxDQUFDLENBQUMsQ0FBQztnQkFDTCxDQUFDO2FBQ0Y7U0FDRixDQUFDO0lBNkNKLENBQUM7SUEzQ0MsaURBQXFCLEdBQXJCO1FBQUEsaUJBZUM7UUFkQyxJQUFJLENBQUMsSUFBSSxDQUFDLElBQUksSUFBSSxJQUFJLENBQUMsTUFBTTtZQUFFLE9BQU87UUFDdEMsSUFBSSxDQUFDLE1BQU0sR0FBRyxJQUFJLENBQUM7UUFDbkIsVUFBVSxDQUFDO1lBQ0gsSUFBQSxlQUF1QyxFQUFyQyw0QkFBVyxFQUFFLDBCQUF3QixDQUFDO1lBQzlDLE1BQU0sQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDLElBQUksQ0FBQyxVQUFDLE1BQU07Z0JBQzNCLElBQUEsMEJBQVEsQ0FBWTtnQkFDNUIsSUFBTSxLQUFLLEdBQUcsSUFBSSxRQUFRLENBQUMsTUFBSSxXQUFhLEVBQUUsVUFBVSxDQUFDLENBQUM7Z0JBQzFELGdGQUFnRjtnQkFDaEYsSUFBSSxLQUFJLENBQUMsSUFBSSxDQUFDLFdBQVc7b0JBQUUsS0FBSSxDQUFDLElBQUksQ0FBQyxXQUFXLENBQUMsVUFBQyxDQUFDLElBQWEsQ0FBQyxHQUFHLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO2dCQUM5RSxnRkFBZ0Y7Z0JBQ2hGLElBQUksS0FBSSxDQUFDLElBQUksQ0FBQyxlQUFlO29CQUFFLEtBQUksQ0FBQyxJQUFJLENBQUMsZUFBZSxDQUFDLFVBQUMsQ0FBQyxJQUFhLENBQUMsR0FBRyxLQUFJLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7Z0JBQ3pGLEtBQUksQ0FBQyxlQUFlLENBQUMsS0FBSSxDQUFDLElBQUksQ0FBQyxDQUFDO1lBQ2xDLENBQUMsQ0FBQyxDQUFDO1FBQ0wsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDO0lBRUQsbUNBQU8sR0FBUCxVQUFRLE9BQU87UUFDYixJQUFJLENBQUMsSUFBSSxDQUFDLElBQUk7WUFBRSxPQUFPO1FBQ3ZCLElBQUksQ0FBQyxJQUFJLENBQUMsT0FBTyxFQUFFLE9BQU8sQ0FBQyxDQUFDO0lBQzlCLENBQUM7SUFFRDs7O09BR0c7SUFDSCwyQ0FBZSxHQUFmLFVBQWdCLEVBQXVCO1FBQXZDLGlCQWdCQztZQWhCaUIsa0JBQU0sRUFBRSw0QkFBVztRQUNuQyx5Q0FBeUM7UUFDekMsSUFBTSxPQUFPLEdBQW1DLE1BQU07YUFDbkQsR0FBRyxDQUFDLFVBQUMsS0FBSyxFQUFFLE9BQU8sSUFBSyxPQUFBLENBQUM7WUFDeEIseUNBQXlDO1lBQ3pDLEVBQUUsRUFBSyxXQUFXLFNBQUksT0FBUztZQUMvQixPQUFPLEVBQUUsQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLE1BQU0sSUFBSSxFQUFFLENBQUMsQ0FBQyxNQUFNLElBQUksRUFBRSxDQUFDLENBQUMsT0FBTyxDQUFDLElBQUksU0FBUztTQUNwRSxDQUFDLEVBSnVCLENBSXZCLENBQUM7YUFDRixNQUFNLENBQUMsVUFBQyxHQUFHLElBQUssT0FBQSxHQUFHLENBQUMsT0FBTyxFQUFYLENBQVcsQ0FBQyxDQUFDO1FBQ2hDLGdFQUFnRTtRQUNoRSxPQUFPLENBQUMsT0FBTyxDQUFDLFVBQUMsR0FBRztZQUNsQixRQUFRLENBQUMsYUFBYSxDQUFDLE1BQUksR0FBRyxDQUFDLEVBQUksQ0FBQyxDQUFDLGFBQWEsQ0FBQyxnQkFBZ0IsQ0FDakUsT0FBTyxFQUNQLGNBQU0sT0FBQSxLQUFJLENBQUMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxPQUFPLENBQUMsRUFBekIsQ0FBeUIsQ0FDaEMsQ0FBQztRQUNKLENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQztJQTFFUTtRQUFSLEtBQUssRUFBRTs7bURBQW9CO0lBRW5CO1FBQVIsS0FBSyxFQUFFOzttREFBVztJQUhSLGlCQUFpQjtRQUo3QixTQUFTLENBQUM7WUFDVCxRQUFRLEVBQUUsYUFBYTtZQUN2Qix1OUhBQThCO1NBQy9CLENBQUM7T0FDVyxpQkFBaUIsQ0E0RTdCO0lBQUQsd0JBQUM7Q0FBQSxBQTVFRCxJQTRFQztTQTVFWSxpQkFBaUIiLCJzb3VyY2VzQ29udGVudCI6WyIvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4vLyBDQVJPVVNFTC50c1xyXG4vLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuaW1wb3J0IHtcclxuICBDb21wb25lbnQsIElucHV0LCBBZnRlckNvbnRlbnRDaGVja2VkXHJcbn0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7IEFuY2hvciB9IGZyb20gJy4uLy4uL3NoYXJlZC1pbnRlcmZhY2VzJztcclxuXHJcbi8qKlxyXG4gKiBJbnRlcmZhY2UgZm9yIFBhZ2luYXRpb25Db21wb25lbnQncyBsaW5rcyAocGFnZXMgYW5kIG5hdmlnYXRpb24gYnV0dG9ucylcclxuICpcclxuICogQHByb3BlcnR5IHRleHQgKHJlcXVpcmVkKVxyXG4gKiBAcHJvcGVydHkgYW5jaG9yIChvcHRpb25hbClcclxuICogQHByb3BlcnR5IGNsYXNzZXMgKG9wdGlvbmFsKVxyXG4gKiBAcHJvcGVydHkgX21ldGEgKG9wdGlvbmFsKVxyXG4gKi9cclxuZXhwb3J0IGludGVyZmFjZSBDYXJvdXNlbEJ1dHRvbiB7XHJcbiAgLyoqXHJcbiAgICogaW5uZXJIVE1MIG9yIHBsYWluIHRleHQgZm9yIHRoZSBsYWJlbFxyXG4gICAqL1xyXG4gIHRleHQ/OiBzdHJpbmc7XHJcbiAgLyoqXHJcbiAgICogYWRkaXRpb25hbCBodG1sIGNsYXNzZXNcclxuICAgKi9cclxuICBjbGFzc2VzPzogc3RyaW5nO1xyXG4gIGFuY2hvcj86IEFuY2hvcjtcclxuICAvKipcclxuICAgKiBhZGRpdGlvbmFsIGluZm9cclxuICAgKi9cclxuICBfbWV0YT86IGFueTtcclxufVxyXG5cclxuLyoqXHJcbiAqIEludGVyZmFjZSBmb3IgUGFnaW5hdGlvbkNvbXBvbmVudCdzIE1ldGFkYXRhIHR1cGxlcyAocGFnZXMgYW5kIG5hdmlnYXRpb24gYnV0dG9ucylcclxuICpcclxuICogQHByb3BlcnR5IGtleSAob3B0aW9uYWwpXHJcbiAqIEBwcm9wZXJ0eSB2YWx1ZSAob3B0aW9uYWwpXHJcbiAqL1xyXG5leHBvcnQgaW50ZXJmYWNlIENhcm91c2VsTWV0YWRhdGEge1xyXG4gIC8qKlxyXG4gICAqIEZpcnN0IGVsZW1lbnRcclxuICAgKi9cclxuICBrZXk/OiBzdHJpbmc7XHJcbiAgLyoqXHJcbiAgICogU2Vjb25kIGVsZW1lbnRcclxuICAgKi9cclxuICB2YWx1ZT86IHN0cmluZztcclxufVxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBDYXJvdXNlbEJhY2tncm91bmRJdGVtIHtcclxuICAvKipcclxuICAgKiBCYWNrZ3JvdW5kIGltYWdlIGZvciB0aGUgY2Fyb3VzZWxcclxuICAgKi9cclxuICBpbWFnZT86IHN0cmluZztcclxuICAvKipcclxuICAgKiBCYWNrZ3JvdW5kIHZpZGVvIGZvciB0aGUgY2Fyb3VzZWxcclxuICAgKi9cclxuICB2aWRlbz86IHtcclxuICAgIC8qKiBNZWRpYSBVUkwgKi9cclxuICAgIHVybDogc3RyaW5nO1xyXG4gICAgLyoqIFBsYWNlaG9sZGVyIGltYWdlIHdoaWxlIGxvYWRpbmcgKi9cclxuICAgIHBvc3Rlcj86IHN0cmluZztcclxuICAgIC8qKiBWaWRlbyB3aWR0aCBpbiBwaXhlbHMgKi9cclxuICAgIHdpZHRoOiBudW1iZXI7XHJcbiAgICAvKiogVmlkZW8gaGVpZ2h0IGluIHBpeGVscyAqL1xyXG4gICAgaGVpZ2h0OiBudW1iZXI7XHJcbiAgfTtcclxuICAvKipcclxuICAgKiBCYWNrZ3JvdW5kIGNvbG9yIGZvciB0aGUgY2Fyb3VzZWxcclxuICAgKi9cclxuICBjb2xvcj86IHN0cmluZztcclxufVxyXG5cclxuLyoqXHJcbiAqIEludGVyZmFjZSBmb3IgQ2Fyb3VzZWxDb21wb25lbnQncyBcIkl0ZW1cIlxyXG4gKlxyXG4gKiBAcHJvcGVydHkgdGl0bGUgKG9wdGlvbmFsKVxyXG4gKiBAcHJvcGVydHkgdGV4dCAob3B0aW9uYWwpXHJcbiAqIEBwcm9wZXJ0eSBtZXRhZGF0YSAob3B0aW9uYWwpXHJcbiAqIEBwcm9wZXJ0eSBhY3Rpb24gKG9wdGlvbmFsKVxyXG4gKiBAcHJvcGVydHkgY2xhc3NlcyAob3B0aW9uYWwpXHJcbiAqIEBwcm9wZXJ0eSBfbWV0YSAob3B0aW9uYWwpXHJcbiAqL1xyXG5leHBvcnQgaW50ZXJmYWNlIENhcm91c2VsRm9yZWdyb3VuZEl0ZW0ge1xyXG4gIC8qKlxyXG4gICAqIEhlYWRlclxyXG4gICAqL1xyXG4gIHRpdGxlPzogc3RyaW5nO1xyXG4gIC8qKlxyXG4gICAqIFRleHQgcGFyYWdyYXBoIC8gc3VidGl0bGUgLyBwcmV0aXRsZVxyXG4gICAqL1xyXG4gIHRleHQ/OiBzdHJpbmc7XHJcbiAgLyoqXHJcbiAgICogTWV0YWRhdGFcclxuICAgKi9cclxuICBtZXRhZGF0YT86IENhcm91c2VsTWV0YWRhdGFbXTtcclxufVxyXG5cclxuLyoqXHJcbiAqIEludGVyZmFjZSBmb3IgQ2Fyb3VzZWxDb21wb25lbnQncyBcImRhdGFcIlxyXG4gKlxyXG4gKiBAcHJvcGVydHkgaXRlbXMgKHJlcXVpcmVkKVxyXG4gKiBAcHJvcGVydHkgaW1hZ2UgKG9wdGlvbmFsKVxyXG4gKiBAcHJvcGVydHkgdmlkZW8gKG9wdGlvbmFsKVxyXG4gKiBAcHJvcGVydHkgY2xhc3NlcyAob3B0aW9uYWwpXHJcbiAqIEBwcm9wZXJ0eSBfbWV0YSAob3B0aW9uYWwpXHJcbiAqL1xyXG5leHBvcnQgaW50ZXJmYWNlIENhcm91c2VsRGF0YSB7XHJcbiAgLyoqXHJcbiAgICogSUQgT2YgdGhlIGNhcm91c2VsIGNvbnRhaW5lclxyXG4gICAqL1xyXG4gIGNvbnRhaW5lcklkOiBzdHJpbmc7XHJcbiAgLyoqXHJcbiAgICogT3B0aW9ucyBmb3IgdGhlIGNhcm91c2VsIGxpYnJhcnkgKCBkb2NzIGhlcmUgOiBodHRwczovL2xhdHRlY2Fyb3VzZWwuZGV2LyApXHJcbiAgICovXHJcbiAgbGliT3B0aW9ucz86IGFueTtcclxuICAvKipcclxuICAgKiBBcnJheSBvZiBjYXJvdXNlbCBzbGlkZXNcclxuICAgKi9cclxuICBzbGlkZXM6IHtcclxuICAgIGl0ZW1zOiBDYXJvdXNlbEZvcmVncm91bmRJdGVtW107XHJcbiAgICAvKipcclxuICAgICAqIEJ1dHRvblxyXG4gICAgICovXHJcbiAgICBhY3Rpb24/OiBDYXJvdXNlbEJ1dHRvbjtcclxuICAgIGJhY2tncm91bmQ/OiBDYXJvdXNlbEJhY2tncm91bmRJdGVtO1xyXG4gICAgY2xhc3Nlcz86IHN0cmluZztcclxuICB9W107XHJcbiAgLyoqXHJcbiAgICogQ2FsbGJhY2sgZm9yIGdldHRpbmcgdGhlIGNhcm91c2VsIGluc3RhbmNlXHJcbiAgICovXHJcbiAgc2V0SW5zdGFuY2U/OiBhbnk7XHJcbiAgLyoqXHJcbiAgICogQ2FsbGJhY2sgdG8gYWNjZXNzIHRoZSBjYXJvdXNlbCBBUElcclxuICAgKiAqL1xyXG4gIHNldENvbXBvbmVudEFQST86IGFueTtcclxuICAvKipcclxuICAgKiBDbGFzc2VzIGZvciB0aGUgY2Fyb3VzZWwgY29tcG9uZW50XHJcbiAgICovXHJcbiAgY2xhc3Nlcz86IHN0cmluZztcclxuICAvKipcclxuICAgKiBBZGRpdGlvbmFsIGRhdGEgdXNlZnVsIGZvciB0aGUgY29tcG9uZW50J3MgbG9naWNcclxuICAgKi9cclxuICBfbWV0YT86IGFueTtcclxufVxyXG5cclxuQENvbXBvbmVudCh7XHJcbiAgc2VsZWN0b3I6ICduNy1jYXJvdXNlbCcsXHJcbiAgdGVtcGxhdGVVcmw6ICcuL2Nhcm91c2VsLmh0bWwnXHJcbn0pXHJcbmV4cG9ydCBjbGFzcyBDYXJvdXNlbENvbXBvbmVudCBpbXBsZW1lbnRzIEFmdGVyQ29udGVudENoZWNrZWQge1xyXG4gIEBJbnB1dCgpIGRhdGE6IENhcm91c2VsRGF0YTtcclxuXHJcbiAgQElucHV0KCkgZW1pdDogYW55O1xyXG5cclxuICBwcml2YXRlIGxvYWRlZCA9IGZhbHNlO1xyXG5cclxuICAvKipcclxuICAgKiBBUEkgb2YgdGhlIGNhcm91c2VsIGNvbXBvbmVudFxyXG4gICAqL1xyXG4gIGFwaSA9IHtcclxuICAgIC8qKlxyXG4gICAgICogVXNlZCB0byBsYXp5LWxvYWQgdmlkZW8gcmVzb3VyY2VzLlxyXG4gICAgICogQ2FsbCBhcGkubG9hZC52aWRlb3Mgb24gRE9NQ29udGVudFJlYWR5IGV2ZW50XHJcbiAgICAgKi9cclxuICAgIGxvYWQ6IHtcclxuICAgICAgLyoqIENoYW5nZXMgYWxsIGRhdGEtc3JjIGF0dHJpYnV0ZXMgdG8gc3JjIGFuZCBjYWxscyA8dmlkZW8+LmxvYWQoKSAqL1xyXG4gICAgICB2aWRlb3M6ICgpID0+IHtcclxuICAgICAgICBjb25zdCBzb3VyY2VzID0gQXJyYXkuZnJvbSggLy8gZ2V0cyBhbGwgPHNvdXJjZS5sYXp5PiB0YWdzXHJcbiAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCh0aGlzLmRhdGEuY29udGFpbmVySWQpXHJcbiAgICAgICAgICAgIC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdsYXp5JylcclxuICAgICAgICApO1xyXG4gICAgICAgIHNvdXJjZXMuZm9yRWFjaCgoc291cmNlOiBIVE1MRWxlbWVudCkgPT4ge1xyXG4gICAgICAgICAgY29uc3QgdXJsID0gc291cmNlLmdldEF0dHJpYnV0ZSgnZGF0YS1zcmMnKTsgLy8gZ2V0cyB0aGUgdmlkZW8gdXJsXHJcbiAgICAgICAgICBzb3VyY2UuY2xhc3NMaXN0LnJlbW92ZSgnbGF6eScpOyAvLyByZW1vdmVzIHRoZSBsYXp5IGNsYXNzXHJcbiAgICAgICAgICBzb3VyY2Uuc2V0QXR0cmlidXRlKCdzcmMnLCB1cmwpOyAvLyBzZXRzIHRoZSB1cmwgdG8gc3JjIGF0dHJpYnV0ZVxyXG4gICAgICAgICAgc291cmNlLnJlbW92ZUF0dHJpYnV0ZSgnZGF0YS1zcmMnKTsgLy8gcmVtb3ZlcyB0aGUgZGF0YS1zcmMgYXR0cmlidXRlXHJcbiAgICAgICAgICAoc291cmNlLnBhcmVudEVsZW1lbnQgYXMgSFRNTFZpZGVvRWxlbWVudCkubG9hZCgpOyAvLyBsb2FkcyB0aGUgdmlkZW9cclxuICAgICAgICB9KTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH07XHJcblxyXG4gIG5nQWZ0ZXJDb250ZW50Q2hlY2tlZCgpOiB2b2lkIHtcclxuICAgIGlmICghdGhpcy5kYXRhIHx8IHRoaXMubG9hZGVkKSByZXR1cm47XHJcbiAgICB0aGlzLmxvYWRlZCA9IHRydWU7XHJcbiAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgY29uc3QgeyBjb250YWluZXJJZCwgbGliT3B0aW9ucyB9ID0gdGhpcy5kYXRhO1xyXG4gICAgICBpbXBvcnQoJ2xhdHRlLWNhcm91c2VsJykudGhlbigobW9kdWxlKSA9PiB7XHJcbiAgICAgICAgY29uc3QgeyBDYXJvdXNlbCB9ID0gbW9kdWxlO1xyXG4gICAgICAgIGNvbnN0IGNoYXJ0ID0gbmV3IENhcm91c2VsKGAjJHtjb250YWluZXJJZH1gLCBsaWJPcHRpb25zKTtcclxuICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tcGFyYW0tcmVhc3NpZ24sIEB0eXBlc2NyaXB0LWVzbGludC9uby11bnVzZWQtdmFyc1xyXG4gICAgICAgIGlmICh0aGlzLmRhdGEuc2V0SW5zdGFuY2UpIHRoaXMuZGF0YS5zZXRJbnN0YW5jZSgoZCk6IHZvaWQgPT4geyBkID0gY2hhcnQ7IH0pO1xyXG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1wYXJhbS1yZWFzc2lnbiwgQHR5cGVzY3JpcHQtZXNsaW50L25vLXVudXNlZC12YXJzXHJcbiAgICAgICAgaWYgKHRoaXMuZGF0YS5zZXRDb21wb25lbnRBUEkpIHRoaXMuZGF0YS5zZXRDb21wb25lbnRBUEkoKGQpOiB2b2lkID0+IHsgZCA9IHRoaXMuYXBpOyB9KTtcclxuICAgICAgICB0aGlzLmFkZEJ1dHRvbkV2ZW50cyh0aGlzLmRhdGEpO1xyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgb25DbGljayhwYXlsb2FkKSB7XHJcbiAgICBpZiAoIXRoaXMuZW1pdCkgcmV0dXJuO1xyXG4gICAgdGhpcy5lbWl0KCdjbGljaycsIHBheWxvYWQpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogRnVuY3Rpb24gdGhhdCBhZGRzIHRoZSBldmVudCBsaXN0ZW5lcnMgdG8gZWFjaCBidXR0b24uXHJcbiAgICogVGhpcyBpcyBuZWVkZWQgYmVjYXVzZSB3aGVuIFwibmV3IENhcm91c2VsKClcIiBpcyBjYWxsZWQgdGhlIGV2ZW50IGxpc3RlbmVycyBhcmUgbG9zdC5cclxuICAgKi9cclxuICBhZGRCdXR0b25FdmVudHMoeyBzbGlkZXMsIGNvbnRhaW5lcklkIH0pIHtcclxuICAgIC8vIEJ1aWxkIGFycmF5IG9mIGJ1dHRvbi1pZCdzICYgcGF5bG9hZHMuXHJcbiAgICBjb25zdCBidXR0b25zOiB7IGlkOiBzdHJpbmc7IHBheWxvYWQ6IGFueSB9W10gPSBzbGlkZXNcclxuICAgICAgLm1hcCgoc2xpZGUsIHNsaWRlSUQpID0+ICh7XHJcbiAgICAgICAgLy8gaWQgPSBjb250YWluZXIgaWQgLSBpbmRleCBvZiB0aGUgc2xpZGVcclxuICAgICAgICBpZDogYCR7Y29udGFpbmVySWR9LSR7c2xpZGVJRH1gLFxyXG4gICAgICAgIHBheWxvYWQ6ICgoKHNsaWRlLmFjdGlvbiB8fCB7fSkuYW5jaG9yIHx8IHt9KS5wYXlsb2FkKSB8fCB1bmRlZmluZWRcclxuICAgICAgfSkpXHJcbiAgICAgIC5maWx0ZXIoKGJ0bikgPT4gYnRuLnBheWxvYWQpO1xyXG4gICAgLy8gZmluZCBlYWNoIGJ1dHRvbidzIGFuY2hvci13cmFwcGVyIGFuZCBhdHRhY2ggdGhlIGV2ZW50IHRvIGl0LlxyXG4gICAgYnV0dG9ucy5mb3JFYWNoKChidG4pID0+IHtcclxuICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgIyR7YnRuLmlkfWApLnBhcmVudEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcclxuICAgICAgICAnY2xpY2snLFxyXG4gICAgICAgICgpID0+IHRoaXMub25DbGljayhidG4ucGF5bG9hZClcclxuICAgICAgKTtcclxuICAgIH0pO1xyXG4gIH1cclxufVxyXG4iXX0=